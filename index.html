<script>
  const FOLDER_ID = '18CzOefCL-ZgPzwbcQx9Ldo116z6JuzfN';
  const API_KEY = 'AIzaSyAj4uz8zML6DlVo9wFK3yVkBw4YQwAKmO8';

  let images = [];
  let current = 0;

  async function fetchImages() {
    const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents+and+mimeType contains 'image/' and trashed=false&fields=files(id)&key=${API_KEY}`;
    try {
      const res = await fetch(url);
      const data = await res.json();
      if (data.files && data.files.length > 0) {
        const newImages = data.files.map(f => `https://lh3.googleusercontent.com/d/${f.id}=w1000`);
        // Actualizamos solo si hay cambios
        if (newImages.length !== images.length) {
          images = newImages;
        }
      }
    } catch (e) {
      console.error('Error al obtener imÃ¡genes:', e);
    }
  }

  function showImage() {
    if (images.length === 0) return;
    const img = document.getElementById('slideshow');
    img.src = images[current];
    img.alt = `Imagen ${current + 1}`;
    img.onerror = () => img.alt = "Imagen no disponible";
    current = (current + 1) % images.length;
  }

  async function startSlideshow() {
    await fetchImages();
    if (images.length === 0) return;
    showImage();
    setInterval(showImage, 10000);       // Cambia de imagen cada 10 segundos
    setInterval(fetchImages, 15000);     // Actualiza la lista cada 30 segundos
  }

  startSlideshow();
</script>

